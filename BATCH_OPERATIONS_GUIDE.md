# 批量操作功能指南

本指南介绍了企业网址导航系统中新增的批量导入导出功能，帮助用户高效管理大量链接数据。

## 功能概览

### 🔄 批量导入导出
- **文件格式支持**: CSV、Excel (.xlsx, .xls)
- **数据验证**: 导入前验证数据格式和URL有效性
- **错误处理**: 详细的错误报告和数据预览
- **模板下载**: 提供标准格式模板文件

### 📋 批量选择管理
- **多选模式**: 支持单个、全选、按分组选择
- **快速筛选**: 按收藏、分组等条件快速选择
- **批量操作**: 删除、移动、编辑、导出等批量操作

### 🛠️ 高级工具
- **数据分析**: 分析链接质量和使用统计
- **数据清理**: 清除重复链接和无效URL
- **格式转换**: 在不同数据格式间转换
- **操作历史**: 记录所有批量操作历史

## 使用方法

### 1. 批量导入

#### 准备数据文件
创建包含以下列的CSV或Excel文件：
- `Name` (必需): 链接名称
- `URL` (必需): 链接地址
- `Description` (可选): 链接描述
- `Group` (必需): 所属分组名称
- `Icon URL` (可选): 图标地址

#### 导入步骤
1. 进入"导入导出工具"页面
2. 选择"导入数据"标签
3. 点击"选择文件"上传数据文件
4. 配置导入选项：
   - ✅ 验证URL有效性
   - ✅ 跳过重复链接
   - ✅ 自动创建缺失分组
   - ✅ 覆盖已存在链接
5. 点击"验证文件"检查数据格式
6. 确认无误后点击"导入数据"

#### 导入选项说明
- **验证URL有效性**: 检查链接是否可访问（可能较慢）
- **跳过重复链接**: 避免导入已存在的URL
- **自动创建分组**: 为不存在的分组自动创建
- **覆盖已存在**: 更新已存在链接的信息

### 2. 批量导出

#### 导出全部数据
1. 选择"导出数据"标签
2. 配置导出选项：
   - 包含所有用户数据
   - 包含分组信息
   - 包含访问统计
   - 包含元数据
3. 选择导出格式（CSV或Excel）
4. 点击"导出数据"

#### 导出特定数据
- **按分组导出**: 选择特定分组进行导出
- **仅导出收藏**: 只导出收藏的链接
- **批量选择导出**: 在批量选择模式下导出选中链接

### 3. 批量选择管理

#### 进入选择模式
1. 在导航页面点击"批量选择"按钮
2. 界面切换到选择模式，显示选择工具栏

#### 选择链接
- **单个选择**: 点击链接卡片上的复选框
- **全选当前**: 选择当前分组的所有链接
- **快速选择**: 使用下拉菜单按条件选择
  - 选择收藏链接
  - 按分组选择
  - 自定义条件选择

#### 批量操作
选择链接后，可以进行以下操作：
- **📁 移动到分组**: 将选中链接移动到指定分组
- **✏️ 批量编辑**: 同时编辑多个链接的属性
- **🗑️ 批量删除**: 删除选中的所有链接
- **📄 导出CSV**: 将选中链接导出为CSV文件
- **📊 导出Excel**: 将选中链接导出为Excel文件

### 4. 高级批量工具

#### 数据分析
- 分析链接访问频率
- 识别无效或重复链接
- 生成使用统计报告

#### 数据清理
- 自动检测重复链接
- 验证链接有效性
- 清理无效图标URL

#### 格式转换
- CSV ↔ Excel 格式转换
- 数据结构标准化
- 批量URL格式化

## API 接口

### 批量操作接口

```typescript
// 批量删除
POST /api/batch/links/delete
{
  "linkIds": [1, 2, 3]
}

// 批量移动
POST /api/batch/links/move
{
  "linkIds": [1, 2, 3],
  "targetGroupId": 5
}

// 批量编辑
POST /api/batch/links/edit
{
  "linkIds": [1, 2, 3],
  "updates": {
    "description": "新描述",
    "isFavorite": true
  }
}

// 批量导出
POST /api/batch/export
{
  "linkIds": [1, 2, 3],
  "format": "xlsx",
  "includeMetadata": true
}
```

### 导入导出接口

```typescript
// 文件导入
POST /api/import/file
FormData: { file: File }

// 验证文件
POST /api/import/validate
FormData: { file: File }

// 批量导入JSON
POST /api/import/batch
{
  "data": [
    {
      "name": "Google",
      "url": "https://google.com",
      "groupName": "搜索引擎"
    }
  ]
}

// 导出数据
GET /api/export?format=xlsx&includeMetadata=true

// 下载模板
GET /api/export/template?format=csv
```

## 数据格式规范

### CSV 格式示例
```csv
Name,URL,Description,Group,Icon URL
Google,https://www.google.com,搜索引擎,工具,https://www.google.com/favicon.ico
GitHub,https://github.com,代码托管,开发,https://github.com/favicon.ico
```

### Excel 格式要求
- 第一行必须是标题行
- 支持多个工作表（使用第一个）
- 单元格格式自动识别

### JSON 格式示例
```json
[
  {
    "name": "Google",
    "url": "https://www.google.com",
    "description": "搜索引擎",
    "groupName": "工具",
    "iconUrl": "https://www.google.com/favicon.ico"
  }
]
```

## 错误处理

### 常见错误类型
1. **格式错误**: 文件格式不支持或损坏
2. **数据错误**: 必需字段缺失或格式不正确
3. **URL错误**: 链接地址无效或无法访问
4. **权限错误**: 没有操作权限或超出限制

### 错误信息示例
```json
{
  "success": false,
  "errors": [
    {
      "row": 3,
      "field": "url",
      "message": "URL格式无效"
    },
    {
      "row": 5,
      "field": "name",
      "message": "名称不能为空"
    }
  ]
}
```

## 性能优化

### 大文件处理
- 支持最大10MB文件上传
- 分批处理大量数据
- 进度显示和取消功能

### 网络优化
- 压缩传输数据
- 断点续传支持
- 并发限制控制

## 安全考虑

### 数据验证
- 严格的输入验证
- SQL注入防护
- XSS攻击防护

### 权限控制
- 用户级别权限检查
- 操作日志记录
- 敏感操作确认

## 故障排除

### 导入失败
1. 检查文件格式是否正确
2. 验证必需字段是否完整
3. 确认URL格式是否有效
4. 检查网络连接状态

### 导出失败
1. 检查浏览器下载设置
2. 确认有足够存储空间
3. 验证用户权限
4. 重试操作

### 批量操作失败
1. 检查选择的链接是否有效
2. 确认目标分组是否存在
3. 验证操作权限
4. 查看详细错误信息

## 更新日志

### v1.0.0 (2024-01-08)
- ✨ 新增批量导入导出功能
- ✨ 新增批量选择管理界面
- ✨ 新增数据验证和预览
- ✨ 新增操作历史记录
- 🐛 修复文件上传限制问题
- 🐛 修复批量操作权限检查

## 技术支持

如果您在使用过程中遇到问题，请：
1. 查看本指南的故障排除部分
2. 检查浏览器控制台错误信息
3. 联系系统管理员获取帮助

---

*本指南会随着功能更新持续完善，请关注最新版本。*